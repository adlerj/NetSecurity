var Analytics=function(e){return this.data=e,this.container=document.getElementById("dataArea"),this};Analytics.prototype.init=function(){this.container.innerHTML="";var e=this.createTimeChart(),t=this.createCommonIPs(),n=this.createCommonAttacks();this.createCommonLocations(),this.hotlinks(e,t,n)},Analytics.prototype.createTimeChart=function(){var e=document.createElement("div");e.classList.add("card","shadow"),this.container.appendChild(e);var t=document.createElement("div");t.className="redline",e.appendChild(t);var n=document.createElement("div");n.className="inner-card",e.appendChild(n);var r=document.createElement("div");r.className="iconandtext",r.style.width="50%",n.appendChild(r);var i=document.createElement("img");i.className="iticon",i.src="images/pie.png",i.alt="Mmm... pie.",r.appendChild(i);var s=document.createElement("h1");s.className="ittext",s.innerHTML="Time Analysis",r.appendChild(s);var o=document.createElement("div");o.classList.add("onepixline","clear"),n.appendChild(o);var u=document.createElement("div");u.className="entry",n.appendChild(u);var a=document.createElement("div");a.id="dashboard",u.appendChild(a);var f=document.createElement("div");f.id="chart",f.style.width="100%",f.style.height="400px",a.appendChild(f);var l=document.createElement("div");l.id="control",l.style.width="100%",l.style.height="50px",a.appendChild(l);var c=new google.visualization.Dashboard(a),h=new google.visualization.ControlWrapper({controlType:"ChartRangeFilter",containerId:"control",options:{filterColumnIndex:0,ui:{chartType:"LineChart",chartOptions:{chartArea:{width:"90%"},hAxis:{baselineColor:"none"}},minRangeSize:864e5}}}),p=new google.visualization.ChartWrapper({chartType:"ColumnChart",containerId:"chart",options:{chartArea:{height:"80%",width:"80%"},hAxis:{slantedText:!1},legend:{position:"none"}},view:{columns:[{calc:function(e,t){return e.getFormattedValue(t,0)},type:"string"},1]}}),d=new google.visualization.DataTable;d.addColumn("date","Date"),d.addColumn("number","Number of Attacks");var v={},m;for(m=0;m<this.data.length;++m){var g=this.data[m],y=g.datetime.split(/[\s:-]/),b=Number(y[0]),w=Number(y[1]),E=Number(y[2]),S=Number(y[3]),x=Number(y[4]),T=Number(y[5]),N=new Date(b,w-1,E,0,0,0,0);v[N]?v[N]++:v[N]=1}var C;for(C in v){var k=new Date(C);d.addRow([k,v[C]])}return c.bind(h,p),c.draw(d),e},Analytics.prototype.createCommonIPs=function(){var e=document.createElement("div");e.classList.add("card","shadow"),this.container.appendChild(e);var t=document.createElement("div");t.className="redline",e.appendChild(t);var n=document.createElement("div");n.className="inner-card",e.appendChild(n);var r=document.createElement("div");r.className="iconandtext",r.style.width="50%",n.appendChild(r);var i=document.createElement("img");i.className="iticon",i.src="images/pie.png",i.alt="Mmm... pie.",r.appendChild(i);var s=document.createElement("h1");s.className="ittext",s.innerHTML="Common IPs",r.appendChild(s);var o={},u;for(u=0;u<this.data.length;++u){var a=this.data[u];if(a.src.indexOf("128.6.238")!==-1)continue;o[a.src]?o[a.src]++:o[a.src]=1}var f=[],l=0;for(h in o)f[o[h]]?f[o[h]].push(h):(f[o[h]]=[],f[o[h]].push(h)),l<o[h]&&(l=o[h]);var c=new google.visualization.DataTable;c.addColumn("string","IP Address"),c.addColumn("number","Number of Occurrences");for(u=l;u>=0;--u)if(f[u]){var h;for(h in f[u])c.addRow([f[u][h],u])}var p={title:"IP Address Occurences"},d=document.createElement("div");d.classList.add("onepixline","clear"),n.appendChild(d);var v=document.createElement("div");v.className="entry",v.style.height="500px",n.appendChild(v);var m=new google.visualization.PieChart(v);m.draw(c,p);var g=0;for(u=l;u>=0;--u)if(f[u]){console.log(u);var y=document.createElement("div");y.classList.add("onepixline","clear"),n.appendChild(y);var b=document.createElement("div");b.className="entry",n.appendChild(b);var w=document.createElement("h2");w.className="entryTitle",w.innerHTML=f[u][0],b.appendChild(w);var E=document.createElement("p");E.className="entryDes",E.innerHTML="<span>With</span> "+u+" <span>associated attack records.</span>",b.appendChild(E),g++;if(g>=5)break}for(u=0;u<0;++u){var y=document.createElement("div");y.classList.add("onepixline","clear"),n.appendChild(y);var b=document.createElement("div");b.className="entry",n.appendChild(b);var S=document.createElement("div");S.className="detButton",S.innerHTML="Details",b.appendChild(S);var w=document.createElement("h2");w.className="entryTitle",w.innerHTML=a.msg,b.appendChild(w);var E=document.createElement("p");E.className="entryDes";var x="AM";hour===0?hour="12":hour>12&&(hour-=12,x="PM"),minutes<10&&(minutes="0"+minutes),seconds<10&&(seconds="0"+seconds),E.innerHTML="<span>From</span> "+a.src+" <span>at</span> "+hour+":"+minutes+":"+seconds+x,b.appendChild(E);var T=document.createElement("p");T.className="entryDes",T.innerHTML="<span>Priority</span> "+a.priority,b.appendChild(T)}return e},Analytics.prototype.createCommonAttacks=function(){var e=document.createElement("div");e.classList.add("card","shadow"),this.container.appendChild(e);var t=document.createElement("div");t.className="redline",e.appendChild(t);var n=document.createElement("div");n.className="inner-card",e.appendChild(n);var r=document.createElement("div");r.className="iconandtext",r.style.width="50%",n.appendChild(r);var i=document.createElement("img");i.className="iticon",i.src="images/pie.png",i.alt="Mmm... pie.",r.appendChild(i);var s=document.createElement("h1");s.className="ittext",s.innerHTML="Common Attacks",r.appendChild(s);var o={},u;for(u=0;u<this.data.length;++u){var a=this.data[u];if(a.src.indexOf("128.6.238")!==-1)continue;o[a.msg]?o[a.msg]++:o[a.msg]=1}var f=[],l=0;for(h in o)f[o[h]]?f[o[h]].push(h):(f[o[h]]=[],f[o[h]].push(h)),l<o[h]&&(l=o[h]);var c=new google.visualization.DataTable;c.addColumn("string","Name of Attack"),c.addColumn("number","Number of Occurrences");for(u=l;u>=0;--u)if(f[u]){var h;for(h in f[u])c.addRow([f[u][h],u])}var p={title:"Attack Occurences"},d=document.createElement("div");d.classList.add("onepixline","clear"),n.appendChild(d);var v=document.createElement("div");v.className="entry",v.style.height="500px",n.appendChild(v);var m=new google.visualization.PieChart(v);m.draw(c,p);var g=0;for(u=l;u>=0;--u)if(f[u]){console.log(u);var y=document.createElement("div");y.classList.add("onepixline","clear"),n.appendChild(y);var b=document.createElement("div");b.className="entry",n.appendChild(b);var w=document.createElement("h2");w.className="entryTitle",w.innerHTML=f[u][0],b.appendChild(w);var E=document.createElement("p");E.className="entryDes",E.innerHTML="<span>With</span> "+u+" <span>associated records.</span>",b.appendChild(E),g++;if(g>=5)break}for(u=0;u<0;++u){var y=document.createElement("div");y.classList.add("onepixline","clear"),n.appendChild(y);var b=document.createElement("div");b.className="entry",n.appendChild(b);var S=document.createElement("div");S.className="detButton",S.innerHTML="Details",b.appendChild(S);var w=document.createElement("h2");w.className="entryTitle",w.innerHTML=a.msg,b.appendChild(w);var E=document.createElement("p");E.className="entryDes";var x="AM";hour===0?hour="12":hour>12&&(hour-=12,x="PM"),minutes<10&&(minutes="0"+minutes),seconds<10&&(seconds="0"+seconds),E.innerHTML="<span>From</span> "+a.src+" <span>at</span> "+hour+":"+minutes+":"+seconds+x,b.appendChild(E);var T=document.createElement("p");T.className="entryDes",T.innerHTML="<span>Priority</span> "+a.priority,b.appendChild(T)}return e},Analytics.prototype.createCommonLocations=function(){},Analytics.prototype.hotlinks=function(e,t,n){var r=document.getElementById("tc"),i=document.getElementById("ip"),s=document.getElementById("att");r.onclick=function(){scrollTo(document.body,e.getBoundingClientRect().top+window.scrollY,200)},i.onclick=function(){scrollTo(document.body,t.getBoundingClientRect().top+window.scrollY,200)},s.onclick=function(){scrollTo(document.body,n.getBoundingClientRect().top+window.scrollY,200)},window.addEventListener("scroll",function(e){return e.preventDefault(),n.getBoundingClientRect().top<=0?(i.classList.remove("underlined"),r.classList.remove("underlined"),s.classList.contains("underlined")||s.classList.add("underlined")):t.getBoundingClientRect().top<=0?(s.classList.remove("underlined"),r.classList.remove("underlined"),i.classList.contains("underlined")||i.classList.add("underlined")):(i.classList.remove("underlined"),s.classList.remove("underlined"),r.classList.contains("underlined")||r.classList.add("underlined")),!1})};var processData=function(){return function(){var e=JSON.parse(this.responseText),t=new Analytics(e);t.init()}},initPageUp=function(){var e=document.getElementById("pageup");e.style.marginLeft="-100px",e.style.marginTop=window.innerHeight-150+"px";var t=function(t){e.onmouseup=t},n=function(e){scrollTo(document.body,0,500),setTimeout(t,500,n)};t(n),e.addEventListener("click",function(){e.onmouseup=null}),window.onresize=function(){e.style.marginTop=window.innerHeight-150+"px"}},registerScroll=function(){var e=document.getElementById("content"),t=document.createElement("div");t.className="bottom-space",e.appendChild(t);var n=!1,r=this;window.addEventListener("scroll",function(e){e.preventDefault();var t=window.innerHeight,r=document.getElementsByClassName("bottom-space")[0].getBoundingClientRect().top,i=document.getElementById("sidebar");if(window.scrollY>100){if(n===!1){var s=document.getElementById("pageup");moveToX(s,20,175),n=!0}var i=document.getElementById("sidebar");i.style.position="fixed",i.style.marginTop="-100px"}else{if(n===!0){var s=document.getElementById("pageup");moveToX(s,-150,175),n=!1}i.style.marginTop="0px",i.style.position="static"}return!1})},init=function(){initPageUp(),registerScroll();var e=processData(),t="http://scarletshield.rutgers.edu/demo/pulltest.php";get(t,e)};google.load("visualization","1.1",{packages:["corechart","controls"]}),window.addEventListener("beforeunload",function(){window.scrollTo(0,0)}),document.addEventListener("DOMContentLoaded",init,!1);var get=function(e,t){var n=new XMLHttpRequest;n.onload=t,n.open("get",e,!0),n.send()},moveToX=function(e,t,n){var r=parseInt(e.style.marginLeft),i=t-r,s=0,o=20,u=function(){s+=o;var t=easeInOutQuad(s,r,i,n);e.style.marginLeft=t+"px",s<n&&setTimeout(u,o)};u()},scrollTo=function(e,t,n){var r=e.scrollTop,i=t-r,s=0,o=20,u=function(){s+=o;var t=easeInOutQuad(s,r,i,n);e.scrollTop=t,s<n&&setTimeout(u,o)};u()},easeInOutQuad=function(e,t,n,r){return e/=r/2,e<1?n/2*e*e+t:(e--,-n/2*(e*(e-2)-1)+t)};